<!DOCTYPE html>
<html>
 <head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="description" content="Appboard - Admin Template with Angularjs" />
  <meta name="keywords" content="appboard, webapp, admin, dashboard, template, ui" />
  <meta name="author" content="solutionportal" />
     <meta name="renderer" content="webkit" />
     <script src="../assets/lib/jquery-1.10.2.min.js"></script>
  <script src="../assets/lib/jquery.cookie.min.js"></script>
  <script src="../assets/lib/md5.js"></script>
  <script src="../assets/js/common-lang.js"></script>
  <script src="../assets/js/common-params.js"></script>
  <script src="../assets/js/common-fn.js"></script>
  <script src="../assets/js/common-env.js"></script>
<!--   <script src="../assets/lib/common.js"></script>
  <script src="../assets/lib/common.js"></script> -->
  <script src="../assets/lib/layer/layer.js"></script>

  <!-- <base href="/"> -->
  <title class="unifTitle"></title>
  <!-- Icons -->
  <!-- Set this in dist folder in index.html file -->
  <!-- Match Media polyfill for IE9 -->
  <!--[if IE 9]><!-->

  <!--<![endif]-->
  <link media="all" href="../assets/fonts/font-awesome/css/font-awesome.css"type="text/css" rel="stylesheet">
  <link media="all" href="../assets/css/index.css" type="text/css" rel="stylesheet" />
  <link media="all" href="../assets/css/main.css" type="text/css" rel="stylesheet">
 <style>
     *{
         font-family: '黑体';
         margin: 0;
         padding: 0;
         font-size: 14px;
     }
     ul li{
         list-style: none;
     }
     .base-width{
         width: 1200px;
         margin:0 auto;
     }
      .base-bg-color{
          background: #c00;
          color: #fff;
      }
     .base-font-color{
         color: #c00;
     }
     .header{
         padding: 5px 0;
         font-size: 10px!important;
         width: 100%;
         z-index: 999;
     }
     .header div{
        font-size: 16px!important;
     }
     .fl{
         float: left;
     }
     .fr{
         float: right;
     }
     .clear:after{
         content: '';
         width: 0;
         height: 0;
         display:block;
         line-height: 0;
         clear: both;
     }
     .m-l-10px{
         margin-left: 10px;
     }
     .nav{
         height: 60px;
         line-height: 60px;
         width: 100%;
         z-index: 999;
         background: #fff;
     }
     .nav .logo{
         width: 110px;
         text-align: center;
     }
     .nav ul{
         position: relative;
     }
     .nav ul li{
         float: left;
         list-style: none;
         color: #232333;
         font-size: 24px;
         margin: 0px 25px;
         cursor: pointer;
         transition: all .3s;
     }
     .nav ul li.active{
         color :#c00;
     }
     .nav .nav-line{
         width: 60px;
         background :#c00;
         height: 3px;
         position: absolute;
         bottom: 10px;
         left: 20px;
         margin: 0;
     }
     .content-top{
         height: 650px;
         position: relative;
         background: #eee;
         min-width: 1200px;
     }
     .content-top-img{
         position: absolute;
         left: 0;
         top: 0;
         width: 100%;
         min-width: 1200px;
         height: 100%;
     }
     .content-top-img li{
         display: none;
         width: 100%;
         height: 100%;
         position: absolute;
     }
     .content-top-img li.fp{
        background: url("../assets/images/lb1.png") no-repeat; 
        background-position:center;
        background-size:cover;
     }
    .content-top-img li.sp{
        background: url("../assets/images/lb2.png") no-repeat;
        background-position:center;
        background-size:cover;
        
     }
    .content-top-img li.sep{
        background: url("../assets/images/lb3.png") no-repeat;
        background-position:center;
        background-size:cover;
       
     }
     .content-top-img li .content-top-img-title{
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
     }
     .content-top-img li.sp .content-top-img-title p{
        color: #fff;
     }
     .content-top-img li .content-top-img-title p{
        font-size: 40px;
        color: #232333;
        font-weight: bold;
        letter-spacing: 10px;
        
     }
     .content-top-img-title-t{
        font-size: 80px!important;
     }
     .content-top-img li img{
        width: 100%;
        height: 100%;
        float: left;
        border-top: 1px solid #c00;
        border-bottom: 1px solid #c00;
     }
     .img-point-tabs{
         position: absolute;
         left: 50%;
         bottom: 50px;
         z-index: 10;
         transform: translateX(-50%);
     }
     .img-point-tabs li{
         width: 25px;
         height: 10px;
         background: #fff;
         margin: 10px;
         border-radius: 20px;
         transition: all .3s;
         float: left;
         cursor: pointer;
     }
     .img-point-tabs li.active{
         width: 40px;
         background: #c00;
     }
     .content-top-inner{
         height: 100%;
         position: relative;
     }
     .content-top-i-l{

     }
     .content-top-i-r{
         position: absolute;
         right: 20px;
         top: 50%;
         transform: translateY(-50%);
         background: #fff;
         padding: 120px 100px;
         width: 500px;
         border: 1px solid #ddd;
     }
     .content-top-i-r input{
        margin: 10px 0;
         border: 1px solid #ccc;
     }
     .cap-input-box{
           overflow: hidden;
     }
    .cap-input-box input{
        margin: 0;
     }
     .captcha-input{
         width: 65%;
         margin: 10px 0;
     }
     .captcha-img{
         width: 35%;
         height: 36.5px;
         border: 1px solid #ddd;
         margin-left: -1px;
     }
     .login-txt{
         padding: 15px 10px 0;
     }
     .login-txt span{
         cursor:pointer;
         color: #c00;
         transition: all .3s;
     }
     .login-txt span:hover{
         color: #a00;
     }
     .login-btn{
         background: #c00;
         width: 100%;
         color: #fff;
         border: 1px solid #b00;
     }
     .login-btn:link, .login-btn:visited, .login-btn:hover, .login-btn:active{
         background: #a00;
         color:#fff;
         border: 1px solid #a00;
     }
     .get-mg-btn{
         background: #c00;
         font-size: 12px;
         color: #fff;
         border: 1px solid #c00;
     }
     .login-tab{
          margin-bottom: 30px;
          font-size: 16px!important;
     }
     .login-tab li{
         padding: 10px;
         border-bottom: 3px solid #666;
         cursor: pointer;
         transition: all .3s;
         font-size:20px;
     }
     .login-tab li.active{
         color: #fff;
         border-bottom: 3px solid #c00;
         background:#c00;
     }
     .myCount{
         transition: all .3s;
         margin-right: 20px;
         position: relative;
         z-index: 999;
     }
     .myCount h3{
         font-weight: bold;
         font-weight: bolder;
         font-size: 18px;
         border: 1px solid #CCC;
         box-shadow: 0px 1px 1px 0px #ccc;
         cursor: pointer;
         padding: 0 30px;
         margin: 0;
         height: 60px;
         line-height: 60px;
     }
     .myCount:hover h3{
         color: #c00;
         text-shadow: 1px 1px 1px #fff;
     }
     .myCount .detail-list{
         height: 0;
         position: absolute;
         left:0;
         top: 60px;
         width: 100%;
         transition: all .1s;
         overflow: hidden;
         background: #fff;

     }
     .myCount .detail-list ul {
         padding: 10px 0;

     }
     .myCount .detail-list li{
         padding: 10px 10%;
         margin: 0;
         width: 100%;
     }
     .myCount .detail-list li:hover{
         background: #f5f5f5;
     }
     .myCount:hover .detail-list{
         height: 200px;
     }
     .content-main{

     }
     .content-main .content-main-title{
         font-size: 22px;
         letter-spacing: 5px;
     }
     .content-main .content-main-title:before{
         content: '';
         display: inline-block;
         width: 5px;
         height: 20px;
         background: #c00;
         border-radius: 100px;
         vertical-align: -2px;
         margin-right: 6px;
     }
     .content-main .content-main-table th{
         background: #800;
         color: #fff;
         font-size: 16px;
     }
     .footer{
         background: #c00;
         color: #fff;
         font-size: 18px;
     }
     .footer-head-title{
         font-size: 22px;
         font-weight: normal;
         display:inline-block;
         padding: 0 10px;
         color: #fff!important;
     }
     .footer-head-title:after{
         content: '';
         display: block;
         width: 100%;
         height: 3px;
         background: #fff;
         border-radius: 50px;
         margin-top: 10px;
     }
     .footer .tel{
         font-size: 28px;
         font-weight: normal;
     }
     .footer-a{
         color: #fff;
         margin: 0 10px;
     }
     .footer-a:hover{
        color: #eee;
     }
     .footer-bottom{
         background:#a00;
         text-align: center;
         padding: 5px;
     }
     .active{
         color: #c00;
     }
     .mt-10px{
        margin-top: 10px;
     }
     .showPicShowBtn{
        display: inline-block;
        padding: 5px 15px;
        background: #c00;
        border-radius: 5px;
        color: #fff;
     }
     button[disabled='disabled']{
         opacity: .6;
     }
 </style>

<script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?1efaeb8a243bcc7f8a0cbe9123c5f2b8";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
</script>

 </head>
 <body id="app" class="app theme-one body-full">

 <!--[if lt IE 8]>

 <![endif]-->
        <header class="base-bg-color header">
            <div class="base-width clear">
                  <div class="fl">
                      <i class="fa fa-phone"></i>
                      客服电话：123-123-123
                  </div>
                    <!-- <div class="fr m-l-10px">
                        <i class="fa fa-asterisk"></i>
                        关于我们
                    </div> -->
            </div>
        </header>
        <nav class="nav  clear">
            <div class="base-width">
                <div class="logo fl">
                    <img style="height: 59px;" src="../assets/images/logo.jpg">
                </div>
                <div class="fl">
                    <span>您的票据融资首选</span>
                </div>
                <!-- <div class="fr myCount">
                    <h3>
                        我的账户
                    </h3>
                    <div class="detail-list">
                        <ul>
                            <li>代售票源</li>
                            <li>了解更多</li>
                        </ul>
                    </div>
                </div> -->
            </div>
        </nav>
        <div class="content-top">
            <ul class="content-top-img" id="contentTopImg">
                <li class="fp">
                    <div class="content-top-img-title">
                        <p class="content-top-img-title-t">商票之家</p>
                        <p>您的票据融资首选</p>
                    </div>
                    <!-- <img src="../assets/images/lb1.png"> -->
                </li>
            </ul>
            <div class="base-width content-top-inner clear">
                 <div class="content-top-i-l fl">

                 </div>
                 <div class="content-top-i-r">
                     <div>
                         <ul class="clear login-tab" id="loginTabs">
                             <li class="fl active">账号登录</li>
                             <li class="fl">手机号登录</li>
                         </ul>
                         <ul id="loginTabsContent">
                             <li style="display:none;" id="nameLogin">
                                 <input class="form-control" autocomplete="off" placeholder="请输入用户名" value="" type="text" id='mcode' />
                                 <input class="form-control" autocomplete="off" placeholder="请输入密码" value="" type="password" id='password' />
                                 <div class="cap-input-box clear">
                                     <input class="form-control fl captcha-input" placeholder="请输入图片验证码" id='vcode0' />
                                     <img class="fl captcha-img" src="" id='captcha0' onclick='getCaptcha()'/>
                                 </div>
                                 <button type="button" id="loginBtn" class="btn btn-lg login-btn w-100p mt-10px">立即登录</button>
                                 <p class="clear blue-font login-txt" ><span onclick="registerMethod()">立即注册</span><span class="fr" onclick="forgetPassword()">忘记密码？</span></p>
                             </li>
                             <li style="display:none;" id="phoneLogin">
                                 <input type="password" style="display:none;">
                                 <input class="form-control" autocomplete="off" placeholder="请输入手机号" value="" type="number" id='phone' />
                                 <div class="cap-input-box clear" style="margin-bottom: 10px;">
                                     <input class="form-control fl captcha-input" placeholder="请输入短信验证码" id='msgCode'  />
                                     <button class="fl captcha-img get-mg-btn" id='getMsg'>获取验证码</button>
                                 </div>
                                 <div class="cap-input-box clear">
                                     <input class="form-control fl captcha-input" placeholder="请输入图片验证码" id='vcode1'  />
                                     <img class="fl captcha-img" src="" id='captcha1' onclick='getCaptcha(1)'/>
                                 </div>
                                 <button id="phoneLoginSubmit" type="button" class="btn btn-lg login-btn w-100p mt-10px">立即登录</button>
                                 <p class="clear blue-font login-txt" ><span onclick="registerMethod()">立即注册</span><span class="fr" onclick="forgetPassword()">忘记密码？</span></p>
                             </li>
                         </ul>
                     </div>
                 </div>
            </div>
        </div>
        <footer class="footer">
            <div class="footer-bottom">
                <div class="clearfix text-center">
                    <p style="margin: 0;"> <strong class="unifTitle" style="font-size:12px;"></strong> <span class="copyright" style="font-size:12px;"></span></p>
                    <!-- <p class="versionInfo"></p> -->
                </div>
            </div>
            <div id="dataView1"></div>
        </footer>

  <!-- Set this in dist index.html -->
  <!-- !End -->
<script type="text/html" id="pic_wrap">
    <div>
        <img src="{{url}}">
    </div>
    <div>
        <span>确认</span>
    </div>
</script>
  <script type="text/javascript">

  jQuery.extend( jQuery.easing,
      {
          easeOutExpo: function (x, t, b, c, d) {
              return (t==d) ? b+c : c * (-Math.pow(2, -10 * t/d) + 1) + b;
          },
          easeOutBounce: function (x, t, b, c, d) {
              if ((t/=d) < (1/2.75)) {
                  return c*(7.5625*t*t) + b;
              } else if (t < (2/2.75)) {
                  return c*(7.5625*(t-=(1.5/2.75))*t + .75) + b;
              } else if (t < (2.5/2.75)) {
                  return c*(7.5625*(t-=(2.25/2.75))*t + .9375) + b;
              } else {
                  return c*(7.5625*(t-=(2.625/2.75))*t + .984375) + b;
              }
          },
      });


    $.zAjax({
      url: project.host()+'/v1/index/platformName' ,
      dataType: "json",
      type:'GET',
      isString:false,
      success: function(data) {
        if(!data.title)return;
        sessionStorage.setItem('unifTitle',data.title);
        sessionStorage.setItem('copyright',data.copyright);
        sessionStorage.setItem('versionInfo',data.versionInfo);
        $('.unifTitle').html(data.title);
        $('.copyright').html(data.copyright);
        $('.versionInfo').html(data.versionInfo);

      }
    });


    function getCaptcha(type){
        type = type || 0;
      $.zAjax({
        url: project.host()+'/v1/captcha',
        // data:data,
        isString:false,
        success: function(data) {
          var str='data:image/jpg;base64,'+data.captchaImage;
          $('#captcha' + type).attr('src',str);
          $('#captcha' + type).attr('_id',data.captchaKey);
        }
      });

      // $('#captcha').attr('src',project.host()+'/captcha?a='+Math.random())
    }

    getCaptcha()

    function getOrg(){
      $.zAjax({
        url: project.host()+'/v1/orgTopList' ,
        isString:false,
        success: function(data) {

        	var str='<option value="">'+lang.getData('inputOrgCode')+'</option>';
        	data.forEach(function(n,i){
        	      str+='<option value='+n.orgId+'>'+n.orgCode+'</option>'
        	});

        	$('#orgId').html(str);

        }
      });
    }

    //getOrg();

    /**
     * 会员登录
     * @return {[type]} [description]
     */
    function loginMethod() {
    	/* var orgId = $.trim($("#orgId").val());
    	if (orgId == "" && orgId.length == 0) {
            layer.tips(lang.getData('orgNotNull'), '#orgId',{ tips: [2, '#5974d9'] });
            return;
        } */
      var mcode = $.trim($("#mcode").val());
      var password = $.trim($("#password").val());
      var vcode    = $.trim($("#vcode0").val());

      if (mcode == "" && mcode.length == 0) {
          layer.tips(lang.getData('loginNameNotNull'), '#mcode',{ tips: [2, '#c00'] });
          return;
      }

      if (password == "" && password.length == 0) {
          layer.tips(lang.getData('pwdNotNull'), '#password',{ tips: [2, '#c00'] });
          return;
      }

      if (vcode == "" && vcode.length == 0) {
          layer.tips(lang.getData('vcodeNotNull'), '#vcode',{ tips: [2, '#c00'] });
          return;
      }
      // var password = md5(password);
      var index=layer.load(2);
      $.zAjax({
           type: 'POST',
           url: project.host()+'/v1/login' ,
           dataType: "json",
           isString:true,
           data:{
        	  //orgId: orgId,
              loginName: mcode,
              password: password,
              captchaCode:vcode,
              captchaKey:$('#captcha0').attr('_id')
            },
           success: function(data) {
              sessionStorage.removeItem('resetPassword');
              if (data.code == '0') {
                  sessionStorage.setItem('data',JSON.stringify(data));
                  if(data.user.resetPassword == 'Y'){
                    sessionStorage.setItem('resetPassword','Y');
                  }
                  window.location.href = "index.html"
              }else{
                  // switch(data.errMsg){
                  //     case "登录名或者密码错误！":
                  //       layer.tips('登录名或者密码错误！', '#mcode',{ tips: [2, '#5974d9'] });
                  //       break;
                  //     case "验证码错误！":
                  //       layer.tips('验证码错误！', '#vcode',{ tips: [2, '#5974d9'] });
                  //       break;
                  //     case "该用户被冻结":
                  //       layer.tips('该用户被冻结', '#mcode',{ tips: [2, '#5974d9'] });
                  //       break;
                  //     default:
                  //     ayer.msg(data.errMsg?data.errMsg:'');
                  // }
                  layer.alert(data.errMsg?data.errMsg:'',{title:lang.getData('errorMsg'),icon:2});
                  getCaptcha();
                  // layer.close(index);//关闭加载层
              }

           },
           error: function(data) {
              layer.msg('请求有误!',{icon:2})
              // safecCode('#codeImg');
              layer.closeAll('loading');
           }
      });
    }


     /**
      * 上下游企业注册
      */
     function registerMethod() {
    	 window.location.href = "loginRegister.html"
     }
	//忘记密码
	function forgetPassword() {
		window.location.href = "forgetPassword.html"
    }

    function getData(){
        var data = {
            faceValue_id: '',//票据金额 underThound 10万以下  thoundToOneMillion 10-100万  moreOneMillion  100万以上   moreFiveMillion  500万以上
            faceValueMin: '',
            faceValueMax: '',
            remainingDays_id: '',//剩余天数 lessThanNinety 90天内   ninetyToHundredEighty 90-180天   hundredEightyToThreeHundredsixty 180-360天
            daysMin: '',
            daysMax: '',
            flaw_id: '',//瑕疵  Y 有   N 无
            credit_id: '',//excellent 优秀   well 良好 ordinary 一般
            pageSize: 10,
            pageNum: 1,
            dueDateSort: '',
            createTimeSort: '',
            amountSort: '',
        },
        url = '/v1/businessTickets';

        $.zAjax({
            url: project.host() + url,
            type: 'post',
            data:data,
            success: function(data) {
                var str = '';
                if(data.code == 0){
                    data.list.forEach(function(item){
                        str += '<tr><td>'+item.updateTime+'</td><td>'+item.acceptor+'</td><td>'+$.zFormatMoney(item.cpAmount)+'元</td><td>'+item.dueDate+'</td><td>'+$.zFormatMoney(item.deductAmount)+'元</td><td>'+item.approvalApr+'%</td></tr>'
                    });
                    $("#contentMainTBody").html(str);
                }else{
                    layer.msg(data.errMsg);
                }

            }
        });
    }

    $(document).ready(function() {
        /*enter键登录*/
        document.onkeydown = function(event){
            var e = event || window.event || arguments.callee.caller.arguments[0];
            if(e && e.keyCode == 13){
                if($('.layui-layer-btn0').length != 0){
                  layer.closeAll();
                  return;
                }
                if(tabIndex == 0){
                    loginMethod();
                }else{
                    phoneLogin();
                }
            }
        };

        //跳转至发布页
        $("#gotoPublish").on('click', function(){
            layer.alert('请完成注册和企业实名认证后，进行此操作，谢谢！');
            // 
            // var url = '../assets/images/loginTip1.jpg';

            // var str = '<div style="width: 100%;"><div style="margin:0 auto;background:url(\' '+url+'\') no-repeat;background-position:center;background-size: cover;width: 400px;height: 330px;"></div><div><span class="showPicShowBtn">确认</span></div></div>';

            // $("#dataView1").html(str)
            // layer.open({
            //     type: 1,
            //     title: false,
            //     content: $('#dataView1'),
            //     area: ['400px', '400px'],
            //     // end: function(){
            //     //     $("#dataView1").html('');
            //     // }
            // });
            // window.location.href = 'index.html#/cpPublish';
        })

        //跳转至首页
        //跳转至发布页
        $("#gotoIndex").on('click', function(){
            layer.alert('请完成注册和企业实名认证后，进行此操作，谢谢！');
            // window.location.href = 'index.html#/index';
        })

        //跳转至票据库
        $("#gotoBillHall").on("click", function(){
            window.location.href = 'billHall.html'
        })


        //获取列表数据
        getData();
        //导航效果
       
        $("#navTabs").on('mouseenter','li', function(){
             var navTabs = $("#navTabs"), navLine = $("#navLine");
             var navTabsO = navTabs.offset(), navLineW = navLine.width();
             var targetOffset = $(this).offset(), targetW = $(this).width();
             $("#navLine").animate({
                 left: Math.abs(targetOffset.left - navTabsO.left) + (targetW - navLineW )/2 + 'px'
             },100, 'easeOutBounce')
        })
            .on('mouseleave', 'li', function(){
            $("#navLine").finish().animate({
                left: '20px'
            })
        });

        // 初始化登录方式 ,切换登录方式
        var tabIndex = 0;
        $("#loginTabs").find('li').eq(0).addClass('active').siblings('li').removeClass('active');
        $("#loginTabsContent").find("li").eq(0).addClass('show').siblings('ul').removeClass('show');
        $("#loginTabs").on('click' , 'li', function(item){
            var index= $(this).index();
            tabIndex = index;
            $(this).addClass('active').siblings('li').removeClass('active');
            $("#loginTabsContent").find("li").eq(index).addClass('show').siblings('li').removeClass('show');
            getCaptcha(index)

        });

        //图片切换
        var imgPointTabsli = $("#imgPointTabs li"), contentTopImgli = $("#contentTopImg li");
        var setImgFn = function(n){
            imgPointTabsli.eq(n).addClass('active').siblings('li').removeClass('active');
            contentTopImgli.eq(n).fadeIn().siblings('li').fadeOut();
        };
        setImgFn(0);

        var imgTabsIntervalN = 0, imgTabsInterval = setInterval(function(){

            imgTabsIntervalN += 1;
            if(imgTabsIntervalN >= imgPointTabsli.length){
                imgTabsIntervalN = 0;
            }
            setImgFn(imgTabsIntervalN);
        }, 5000);


        imgPointTabsli.on('click', function(){
            $(this).addClass('active').siblings('li').removeClass('active');
            contentTopImgli.eq($(this).index()).fadeIn().siblings('li').hide();
            imgTabsIntervalN = $(this).index();
            clearInterval(imgTabsInterval);
            imgTabsInterval = setInterval(function(){
                imgTabsIntervalN += 1;
                if(imgTabsIntervalN >= imgPointTabsli.length){
                    imgTabsIntervalN = 0;
                }
                setImgFn(imgTabsIntervalN);
            }, 5000);
        });

        //获取短信验证码
        var smsCaptchaKey;
        $("#getMsg").on('click', function(){
            var phone = $.trim($("#phone").val());
            var reg = /^[1][3,4,5,7,8][0-9]{9}$/;
            if (phone == "" && !reg.test(phone)) {
                layer.tips('请输入手机号', '#phone',{ tips: [2, '#c00'] });
                return false;
            }
            var n = 60, _this = this, interval;

            $(_this).html('' + n + '秒后获取').attr('disabled', 'disabled');
            $.zAjax({
                url: project.host()+'/v1/smsCaptcha/?phoneNumber=' + phone + '&type=01',
                // data:data,
                isString:false,
                success: function(data) {
                    // $('[name="smsCaptchaKey"]').val(data.smsCaptchaKey);
                    smsCaptchaKey = data.smsCaptchaKey;

                    interval = setInterval(function(){
                        n -= 1;
                        $(_this).html('' + n + '秒后获取').attr('disabled', 'disabled');

                        if(n <= 0){
                            clearInterval(interval);
                            $(_this).html('获取验证码').removeAttr('disabled');
                        }
                    }, 1000)
                },
                error: function(){
                    clearInterval(interval);
                    $(_this).html('获取验证码').removeAttr('disabled');
                }
            });
        });


        function phoneLogin(){
            var phone = $.trim($("#phone").val());
            var smsCaptcha    = $.trim($("#msgCode").val());
            var captchaCode = $.trim($("#vcode1").val());
            var reg = /^[1][3,4,5,7,8][0-9]{9}$/;
            if (phone == "" && !reg.test(phone)) {
                layer.tips('请输入手机号', '#mcode',{ tips: [2, '#c00'] });
                return;
            }

            if (smsCaptcha == "" && smsCaptcha.length == 0) {
                layer.tips('请输入短信验证码', '#msgCode',{ tips: [2, '#c00'] });
                return;
            }

            if (captchaCode == "" && captchaCode.length == 0) {
                layer.tips('请输入图片验证码', '#vcode1',{ tips: [2, '#c00'] });
                return;
            }
              // var password = md5(password);
              var index=layer.load(2);
              $.zAjax({
                   type: 'POST',
                   url: project.host()+'/v1/login' ,
                   dataType: "json",
                   isString:true,
                   data:{
                      loginName: phone,
                      smsKey: smsCaptchaKey,
                      smsCode: smsCaptcha,
                      captchaCode:captchaCode,
                      captchaKey:$('#captcha1').attr('_id'),
                      type: '01'
                    },
                   success: function(data) {
                      sessionStorage.removeItem('resetPassword');
                      if (data.code == '0') {
                          sessionStorage.setItem('data',JSON.stringify(data));
                          if(data.user.resetPassword == 'Y'){
                            sessionStorage.setItem('resetPassword','Y');
                          }
                          window.location.href = "index.html"
                      }else{
                          
                          layer.alert(data.errMsg?data.errMsg:'',{title:lang.getData('errorMsg'),icon:2});
                          getCaptcha(1);
                          // layer.close(index);//关闭加载层
                      }

                   },
                   error: function(data) {
                      layer.msg('请求有误!',{icon:2})
                      // safecCode('#codeImg');
                      layer.closeAll('loading');



                   }
              });
        }
        //手机号码登录
        $("#phoneLoginSubmit").on("click", phoneLogin)

    });

    $('#loginBtn').click(function(){
      loginMethod()
    });

    $('#registerBtn').click(function(){
    	registerMethod()
      });
    $('#registerBtn').html(lang.getData('register'));

    $('#loginBtn').html(lang.getData('login'));
    $('#loginTo').html(lang.getData('loginTo'));
    // $('#mcode').attr('placeholder',lang.getData('inputId'));
    $('#password').attr('placeholder',lang.getData('inputPwd'));
    $('#vcode').attr('placeholder',lang.getData('inputVcode'));
    //$('#vcode').attr('placeholder',lang.getData('inputOrgCode'));
  </script>
 </body>
</html>
